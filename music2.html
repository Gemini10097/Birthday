<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>生日快乐！</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    primary: '#FF6B8B',
                    secondary: '#FFD700',
                    accent: '#9370DB',
                },
                fontFamily: {
                    birthday: ['"Comic Sans MS"', '"Marker Felt"', 'cursive'],
                },
            }
        }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .text-shadow-glow {
            text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #FFD700, 0 0 40px #FFD700, 0 0 50px #FFD700;
        }
        .float {
            animation: float 3s ease-in-out infinite;
        }
        .spin-slow {
            animation: spin 15s linear infinite;
        }
        .pulse-slow {
            animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .music-toast {
            animation: slideUp 0.5s ease-out forwards, fadeOut 0.5s ease-in 3s forwards;
        }
        .quantum-particle {
            position: absolute;
            border-radius: 50%;
            opacity: 0.7;
            pointer-events: none;
        }
        .countdown-enter {
            animation: countdownEnter 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        .countdown-exit {
            animation: countdownExit 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        /* 满屏烟花容器样式 */
        .fullscreen-fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        /* 16:9视频容器 */
        .aspect-16x9 {
            aspect-ratio: 16 / 9;
        }
    }

    @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-15px); }
        100% { transform: translateY(0px); }
    }

    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; visibility: hidden; }
    }

    @keyframes countdownEnter {
        0% { transform: scale(0); opacity: 0; text-shadow: 0 0 0 transparent; }
        70% { transform: scale(1.1); opacity: 1; }
        100% { transform: scale(1); opacity: 1; text-shadow: 0 0 20px currentColor, 0 0 40px currentColor; }
    }

    @keyframes countdownExit {
        0% { transform: scale(1); opacity: 1; text-shadow: 0 0 20px currentColor, 0 0 40px currentColor; }
        100% { transform: scale(1.5); opacity: 0; text-shadow: 0 0 0 transparent; }
    }

    /* 量子渲染效果 */
    @keyframes quantumFade {
        0%, 100% { opacity: 0.3; transform: scale(0.8); }
        50% { opacity: 0.8; transform: scale(1.2); }
    }

    @keyframes quantumMove {
        0% { transform: translate(0, 0) rotate(0deg); }
        25% { transform: translate(10px, -10px) rotate(90deg); }
        50% { transform: translate(20px, 5px) rotate(180deg); }
        75% { transform: translate(5px, 15px) rotate(270deg); }
        100% { transform: translate(0, 0) rotate(360deg); }
    }

    /* 翻书动画样式 */
    .book {
      position: relative;
      width: 100%;
      min-height: 100vh;
      perspective: 1500px;
      padding-top: 20px;
    }

    .page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      min-height: 100vh;
      transform-origin: left center;
      transform-style: preserve-3d;
      transition: transform 0.8s cubic-bezier(0.6, 0.01, 0.4, 1);
      padding: 20px;
      background-color: white;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      will-change: transform, box-shadow;
      overflow: hidden;
    }

    /* 页角弯曲效果 */
    .page::before {
      content: "";
      position: absolute;
      right: 0;
      bottom: 0;
      width: 30%;
      height: 30%;
      background: linear-gradient(135deg, transparent 50%, rgba(0,0,0,0.03) 50%);
      transform-origin: right bottom;
      transition: transform 0.8s cubic-bezier(0.6, 0.01, 0.4, 1);
      pointer-events: none;
      z-index: 1;
    }

    .page.active {
      z-index: 10;
      transform: rotateY(0deg);
    }

    .page.active::before {
      transform: rotateY(0deg) scale(1);
    }

    .page.flipping {
      z-index: 15;
      transform: rotateY(-180deg);
    }

    .page.flipping::before {
      transform: rotateY(180deg) scale(0.8);
    }

    .page.next {
      z-index: 5;
      transform: rotateY(0deg);
    }

    .page.prev {
      z-index: 5;
      transform: rotateY(-180deg);
      box-shadow: inset 0 0 50px rgba(0,0,0,0.1), -2px 0 10px rgba(0,0,0,0.05);
    }

    .pagination {
      position: fixed;
      bottom: 40px;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      z-index: 20;
    }

    .page-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: white;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: #FF6B8B;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .page-btn:hover {
      transform: scale(1.1);
      background: #FF6B8B;
      color: white;
    }

    .page-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* 背面样式 - 增强3D效果 */
    .page .back {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #f5f5f5;
      transform: rotateY(180deg);
      backface-visibility: hidden;
      padding: 20px;
    }

    /* 倒计时覆盖层 */
    #countdown-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0a0a16;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 100;
        transition: opacity 1s ease-out;
        overflow: hidden;
    }

    #countdown-number {
        font-size: clamp(8rem, 25vw, 18rem);
        font-weight: bold;
        color: #FFD700;
        opacity: 0;
    }

    #countdown-text {
        margin-top: 2rem;
        font-size: clamp(1.2rem, 3vw, 2rem);
        color: #f1f1f1;
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    /* 当前播放歌曲指示器 */
    .music-indicator {
        position: fixed;
        bottom: 24px;
        right: 48px;
        background: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        color: #FF6B8B;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        z-index: 15;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100 overflow-x-hidden">
<!-- 倒计时覆盖层 -->
<div id="countdown-overlay">
  <div id="countdown-number"></div>
  <div id="countdown-text">准备好接收祝福了吗？</div>
  <!-- 量子粒子容器 -->
  <div id="quantum-container"></div>
</div>

<!-- 背景装饰 -->
<div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
  <div class="absolute top-10 left-10 w-20 h-20 bg-secondary/30 rounded-full blur-xl float"></div>
  <div class="absolute top-40 right-20 w-32 h-32 bg-primary/20 rounded-full blur-xl" style="animation: float 4s ease-in-out infinite"></div>
  <div class="absolute bottom-20 left-1/3 w-24 h-24 bg-accent/20 rounded-full blur-xl" style="animation: float 5s ease-in-out infinite"></div>
</div>

<!-- 音乐播放引导提示 -->
<div id="music-guide" class="music-toast fixed top-6 left-1/2 transform -translate-x-1/2 bg-primary/90 text-white px-6 py-3 rounded-full shadow-lg z-50 flex items-center gap-2">
  <i class="fa fa-music"></i>
  <span>点击页面任意位置开启音乐</span>
</div>

<!-- 当前播放歌曲指示器 -->
<div class="music-indicator" id="music-indicator">
  正在播放: 生日快乐歌
</div>

<!-- 主容器（翻书容器） -->
<div class="book z-10 opacity-0 transition-opacity 1s ease">
  <!-- 第一页：满屏烟花效果 -->
  <div class="page active">
    <div class="back"></div> <!-- 背面 -->

    <!-- 粉色到紫色渐变背景 -->
    <div class="absolute inset-0 bg-gradient-to-br from-pink-300 via-purple-200 to-purple-400 animate-gradient-flow z-[-1]"></div>

    <!-- 柔光效果叠加 -->
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_top,rgba(255,255,255,0.4),transparent_70%)] z-[-1]"></div>

    <!-- 满屏烟花容器 -->
    <div id="first-page-fireworks" class="fullscreen-fireworks"></div>

    <div class="text-center my-10 relative z-10">
      <img src="https://s1.aigei.com/src/img/gif/00/00e08c36d96b4ace9c961487dd4689b6.gif?imageMogr2/auto-orient/thumbnail/!282x282r/gravity/Center/crop/282x282/quality/85/%7CimageView2/2/w/282&e=2051020800&token=P7S2Xpzfz11vAkASLTkfHN7Fw-oOZBecqeJaxypL:-QXwl7QyyyTw9_HrcX8sYxNrFxs= " alt="生日蛋糕的图片" class="mx-auto max-w-full h-auto" width="500" height="200">
    </div>
    <div class="container mx-auto px-4 py-8 relative z-10">
      <div class="text-center my-10">
        <img src="https://wimg.588ku.com/gif/20/12/21/861c97babe0d4e6ca15fa4ac49c2dae7.gif" alt="生日快乐的图片" class="mx-auto max-w-full h-auto">
      </div>
    </div>
    <div class="text-center my-16">
      <p class="text-gray-600 mb-6">喜欢这个祝福吗？</p>
      <div class="flex justify-center gap-6">
        <button id="like-btn" class="text-4xl text-gray-400 hover:text-red-500 transition-colors duration-300 transform hover:scale-125">
          <i class="fa fa-heart-o"></i>
        </button>
        <button id="share-btn" class="text-4xl text-gray-400 hover:text-blue-500 transition-colors duration-300 transform hover:scale-125">
          <i class="fa fa-share-alt"></i>
        </button>
      </div>
    </div>

  </div>

  <style>
    /* 渐变流动动画 */
    @keyframes gradientFlow {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    .animate-gradient-flow {
      background-size: 200% 200%;
      animation: gradientFlow 18s ease infinite;
    }
  </style>

  <div class="page next relative overflow-hidden">
    <div class="back"></div> <!-- 背面 -->

    <!-- 生日主题背景图（按比例充满屏幕） -->
    <div class="absolute inset-0 z-0">
      <!-- 背景图容器：确保图片按比例充满屏幕 -->
      <div class="absolute inset-0 flex items-center justify-center">
        <img
                src="https://b0.bdstatic.com/ugc/9Z0yYA0kA8CvlTnKzwUHQg515d30ee2fd8053ef9b4e8ff83fc4c0b.jpg?x-bce-process=image/auto-orient,o_1/watermark,image_NDU0ZjAyZDU5YjQ1LnBuZw==,bucket_searchbox,w_32,text_QFN0ZWxsb3Jh,type_RlpMYW5UaW5nSGVp,size_32,x_22,y_22,interval_4,color_FFFFFF,effect_softoutline,shc_000000,blr_2,align_1"
                alt="生日主题照片"
                class="min-w-full min-h-full object-cover <!-- 核心：按比例充满屏幕，可能裁剪边缘 -->
                     transition-all duration-7000 ease-in-out
                     hover:scale-105 hover:blur-0 hover:brightness-100
                     blur-sm brightness-110"
                loading="eager">
      </div>
    </div>

    <h2 class="text-center font-birthday text-[clamp(1.5rem,5vw,2.5rem)] text-primary text-shadow my-8 relative z-10">美好回忆</h2>

    <!-- 9张回忆照片（居中显示，前景层级） -->
    <div class="grid grid-cols-3 gap-4 max-w-4xl mx-auto relative z-10 justify-items-center content-center mb-8">
      <img src="https://img2.baidu.com/it/u=129933530,533113186&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=1067" alt="回忆照片1" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://wx2.sinaimg.cn/mw1024/00698S0sly1hu1ny9fnb4j31jk110dre.jpg" alt="回忆照片2" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://ts4.tc.mm.bing.net/th/id/OIP-C.07P9LyH1Hv9c9wnafa5rEQHaJM?r=0&cb=thfc1&rs=1&pid=ImgDetMain&o=7&rm=3" alt="回忆照片3" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://img1.baidu.com/it/u=2330405235,2981246960&fm=253&app=138&f=JPEG?w=800&h=1067" alt="回忆照片4" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://ts1.tc.mm.bing.net/th/id/R-C.e89208fec66a12af6aea033d1a55722f?rik=q0QaSt5QQ%2bW7ug&riu=http%3a%2f%2fi2.hdslb.com%2fbfs%2farchive%2feef69f8ab45fab305058218930d2878a1a1a80a8.jpg&ehk=9lR0J7Y1ByKFMu8FQi4YTUe5LkI0EmnTQ41dsJoWR88%3d&risl=&pid=ImgRaw&r=0" alt="回忆照片5" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://wx4.sinaimg.cn/mw690/006ZLRqcgy1hxe77u7kbdj316o1kw7gj.jpg" alt="回忆照片6" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://wx3.sinaimg.cn/mw690/640c032aly1hwnpo4kd1gj2140140af0.jpg" alt="回忆照片7" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://img1.baidu.com/it/u=3643289845,1370422175&fm=253&fmt=auto&app=138&f=JPEG?w=949&h=633" alt="回忆照片8" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
      <img src="https://wx4.sinaimg.cn/mw690/640c032aly1hwnpo46kenj20tw13x425.jpg" alt="回忆照片9" class="rounded-xl shadow-md w-full h-40 object-cover hover:scale-105 transition-transform duration-300">
    </div>

    <p class="text-center font-birthday text-gray-600 mt-4 text-[clamp(1rem,3vw,1.2rem)] relative z-10 pb-8">每一段回忆都是珍贵的礼物 ✨</p>
  </div>



  <!-- 第三页：B站视频版 -->
  <div class="page next">
    <div class="back"></div> <!-- 背面 -->
    <div class="absolute inset-0 flex items-center justify-center">
      <img
              src="https://b0.bdstatic.com/ugc/9Z0yYA0kA8CvlTnKzwUHQga5b1a3fb451649cc4fb8ffba040dad8b.jpg?x-bce-process=image/auto-orient,o_1/watermark,image_NDU0ZjAyZDU5YjQ1LnBuZw==,bucket_searchbox,w_32,text_QFN0ZWxsb3Jh,type_RlpMYW5UaW5nSGVp,size_32,x_22,y_22,interval_4,color_FFFFFF,effect_softoutline,shc_000000,blr_2,align_1"
              alt="生日主题照片"
              class="min-w-full min-h-full object-cover <!-- 核心：按比例充满屏幕，可能裁剪边缘 -->
                     transition-all duration-7000 ease-in-out
                     hover:scale-105 hover:blur-0 hover:brightness-100
                     blur-sm brightness-110"
              loading="eager">
    </div>

    <h2 class="text-center font-birthday text-[clamp(1.5rem,5vw,2.5rem)] text-accent text-shadow my-8">生日快乐！</h2>

    <!-- 16:9比例的B站视频容器 -->
    <div class="text-center my-10 max-w-4xl mx-auto">
      <div class="relative rounded-2xl shadow-lg overflow-hidden aspect-16x9 bg-gray-100">
        <!-- B站视频嵌入容器 -->
        <div id="bilibili-video-container" class="w-full h-full"></div>

        <!-- 视频加载前的占位效果 -->
        <div class="absolute inset-0 bg-gradient-to-r from-gray-200 to-gray-100 animate-pulse" id="video-placeholder"></div>
      </div>
      <p class="text-sm text-gray-500 mt-2">点击视频开始播放</p>
    </div>

    <div class="max-w-xl mx-auto bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl p-6 my-8 text-center">
      <p class="font-birthday text-[clamp(1.2rem,4vw,1.5rem)] text-gray-700">
        愿这一天充满欢笑和爱<br>新的一岁继续闪闪发光！
      </p>
    </div>

    <div class="text-center mt-12">
      <i class="fa fa-star text-secondary text-2xl float"></i>
      <i class="fa fa-star text-primary text-2xl float" style="animation-delay: 0.5s"></i>
      <i class="fa fa-star text-accent text-2xl float" style="animation-delay: 1s"></i>
    </div>
  </div>

  <script>
    // B站视频嵌入代码
    document.addEventListener('DOMContentLoaded', () => {
        // B站视频AV号或BV号（二选一）
        const bvid = "BV1XX4y1P79e"; // BV号示例（生日相关视频）
        // const aid = "170001"; // AV号示例，使用时需要注释掉上面的BV号

        // 视频宽度和高度比例
        const width = "100%";
        const height = "100%";

        // 视频占位符
        const videoPlaceholder = document.getElementById('video-placeholder');

        // 创建B站视频iframe
        function createBilibiliVideo() {
            // 构建B站嵌入链接
            let embedUrl;
            if (bvid) {
                embedUrl = `//player.bilibili.com/player.html?isOutside=true&aid=114680022435313&bvid=BV1jCM1zFEvp&cid=30487875211&p=1`;
            } else if (aid) {
                embedUrl = `//player.bilibili.com/player.html?isOutside=true&aid=114680022435313&bvid=BV1jCM1zFEvp&cid=30487875211&p=1`;
            }

            // 创建iframe元素
            const iframe = document.createElement('iframe');
            iframe.src = embedUrl;
            iframe.width = width;
            iframe.height = height;
            iframe.frameBorder = "0";
            iframe.allowFullscreen = true;
            iframe.scrolling = "no";
            iframe.title = "B站生日视频";
            iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');

            // 加载完成后隐藏占位符
            iframe.onload = () => {
                if (videoPlaceholder) {
                    videoPlaceholder.style.display = 'none';
                }
            };

            // 添加到容器
            const container = document.getElementById('bilibili-video-container');
            if (container) {
                container.appendChild(iframe);

                // 添加点击播放支持
                container.addEventListener('click', () => {
                    // 尝试触发播放
                    try {
                        // 向iframe发送播放指令
                        iframe.contentWindow.postMessage({
                            event: 'play'
                        }, 'https://player.bilibili.com');
                    } catch (e) {
                        console.log('播放请求请求:', e);
                    }
                });
            }
        }

        // 初始化B站视频
        createBilibiliVideo();
    });
  </script>



  <!-- 第四页：温馨祝福页 -->
  <div class="page next">
    <div class="back"></div> <!-- 背面 -->
    <div class="absolute inset-0 flex items-center justify-center">
      <img
              src="https://wx2.sinaimg.cn/mw690/0084HNCEly1i2jq1thayxj32bc1jkb2a.jpg"
              alt="生日主题照片"
              class="min-w-full min-h-full object-cover <!-- 核心：按比例充满屏幕，可能裁剪边缘 -->
                     transition-all duration-7000 ease-in-out
                     hover:scale-105 hover:blur-0 hover:brightness-100
                     blur-sm brightness-110"
              loading="eager">
    </div>
    <h2 class="text-center font-birthday text-[clamp(1.5rem,5vw,2.5rem)] text-primary text-shadow my-8">温馨祝福</h2>

    <div class="max-w-2xl mx-auto bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl p-8 transform transition-all duration-500 hover:scale-[1.02]
                absolute left-1/2 top-[66.66%] -translate-x-1/2 -translate-y-1/2">
      <div id="wish-container" class="text-center font-birthday text-[clamp(1.2rem,4vw,1.8rem)] text-gray-800 min-h-[120px]">
        点击下方按钮开始接收祝福吧！
      </div>

      <div class="flex justify-center mt-8">
        <button id="wish-btn" class="bg-primary hover:bg-primary/80 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition-all duration-300 hover:scale-105 flex items-center">
          <i class="fa fa-gift mr-2"></i> 接收祝福
        </button>
      </div>
    </div>

    <!-- 底部 -->
    <footer class="text-center text-gray-500 text-sm mt-16">
      <p>祝你拥有美好的一天！</p>
    </footer>
  </div>

  <!-- 翻页按钮 -->
  <div class="pagination">
    <div id="prev-btn" class="page-btn" disabled>
      <i class="fa fa-chevron-left"></i>
    </div>
    <div id="next-btn" class="page-btn">
      <i class="fa fa-chevron-right"></i>
    </div>
  </div>
</div>

<!-- 音乐元素 - 多首歌曲 -->
<div id="music-container">
  <audio id="music-1" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3 " type="audio/mpeg">
  </audio>
  <audio id="music-2" loop>
    <source src="https://er-sycdn.kuwo.cn/e18f20618745aa539580ad7a9d2aada4/68a186d9/resource/30106/trackmedia/M800003YYetu3dMfiM.mp3" type="audio/mpeg">
  </audio>
  <audio id="music-3" loop>
    <source src="https://er-sycdn.kuwo.cn/e18f20618745aa539580ad7a9d2aada4/68a186d9/resource/30106/trackmedia/M800003YYetu3dMfiM.mp3" type="audio/mpeg">
  </audio>
  <audio id="music-4" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-13.mp3" type="audio/mpeg">
  </audio>
</div>

<!-- 音乐控制器 -->
<div class="fixed bottom-6 right-6 z-20">
  <button id="music-toggle" class="w-14 h-14 bg-white rounded-full shadow-lg flex items-center justify-center text-primary hover:bg-primary hover:text-white transition-all duration-300">
    <i class="fa fa-music text-xl"></i>
  </button>
</div>

<!-- 烟花效果容器 -->
<div id="fireworks-container" class="fixed inset-0 pointer-events-none z-30"></div>

<script>
  // 等待DOM加载完成
  document.addEventListener('DOMContentLoaded', () => {
      // 倒计时和量子渲染效果
      const countdownOverlay = document.getElementById('countdown-overlay');
      const countdownNumber = document.getElementById('countdown-number');
      const countdownText = document.getElementById('countdown-text');
      const quantumContainer = document.getElementById('quantum-container');
      const book = document.querySelector('.book');
      const firstPageFireworks = document.getElementById('first-page-fireworks');

      // 视频相关元素
      const videoElement = document.querySelector('video');
      const videoPlaceholder = document.getElementById('video-placeholder');

      // 视频加载完成后隐藏占位符
      if (videoElement && videoPlaceholder) {
        videoElement.addEventListener('loadeddata', () => {
          videoPlaceholder.style.display = 'none';
        });
      }

      // 创建量子粒子
      function createQuantumParticles(count) {
          for (let i = 0; i < count; i++) {
              const particle = document.createElement('div');
              particle.classList.add('quantum-particle');

              // 随机属性
              const size = Math.random() * 8 + 2;
              const color = `rgba(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255}, 0.7)`;
              const left = Math.random() * 100;
              const top = Math.random() * 100;
              const duration = Math.random() * 10 + 5;
              const delay = Math.random() * 5;

              particle.style.cssText = `
                  width: ${size}px;
                  height: ${size}px;
                  background: ${color};
                  left: ${left}%;
                  top: ${top}%;
                  animation: quantumFade ${duration}s ease-in-out infinite,
                             quantumMove ${duration * 2}s linear infinite;
                  animation-delay: ${delay}s;
              `;

              quantumContainer.appendChild(particle);
          }
      }

      // 开始倒计时
      function startCountdown() {
          // 显示量子渲染文本
          setTimeout(() => {
              countdownText.style.opacity = 1;
          }, 500);

          // 创建量子粒子效果
          createQuantumParticles(100);

          // 倒计时序列
          const countdownSequence = [3, 2, 1,'🎉'];
          let index = 0;

          function showNextNumber() {
              if (index < countdownSequence.length) {
                  // 重置动画
                  countdownNumber.classList.remove('countdown-enter', 'countdown-exit');
                  void countdownNumber.offsetWidth; // 触发重绘

                  // 设置数字并添加进入动画
                  countdownNumber.textContent = countdownSequence[index];
                  countdownNumber.classList.add('countdown-enter');

                  // 数字停留时间（最后一个表情停留稍短）
                  const delay = index === countdownSequence.length - 1 ? 800 : 1000;

                  // 添加退出动画
                  setTimeout(() => {
                      countdownNumber.classList.remove('countdown-enter');
                      countdownNumber.classList.add('countdown-exit');
                      index++;
                      setTimeout(showNextNumber, 500);
                  }, delay);
              } else {
                  // 倒计时结束，隐藏覆盖层
                  setTimeout(() => {
                      countdownOverlay.style.opacity = 0;
                      setTimeout(() => {
                          countdownOverlay.style.display = 'none';
                          book.style.opacity = 1;
                          // 第一页显示持续烟花效果
                          startFirstPageFireworks();
                          // 初始化音乐
                          if (isPlaying) {
                              playPageMusic(currentPage);
                          }
                      }, 1000);
                  }, 500);
              }
          }

          // 开始倒计时
          showNextNumber();
      }

      // 第一页满屏烟花效果 - 增强版
      function startFirstPageFireworks() {
          // 初始爆发一批烟花（更多数量，更强视觉冲击）
          createFireworks(30, firstPageFireworks);

          // 持续发射烟花，频率和数量动态变化
          let fireworkCount = 3;
          let interval = 1000;

          const fireworkInterval = setInterval(() => {
              // 只有在第一页才继续发射烟花
              if (currentPage === 0) {
                  createFireworks(fireworkCount, firstPageFireworks);

                  // 动态调整烟花数量和频率，创造节奏变化
                  fireworkCount = Math.floor(Math.random() * 5) + 2;
                  interval = Math.floor(Math.random() * 800) + 800;
                  clearInterval(fireworkInterval);

                  // 重新设置定时器
                  fireworkInterval = setInterval(() => {
                      if (currentPage === 0) {
                          createFireworks(fireworkCount, firstPageFireworks);
                      } else {
                          clearInterval(fireworkInterval);
                      }
                  }, interval);
              } else {
                  clearInterval(fireworkInterval);
              }
          }, interval);
      }

      // 开始倒计时
      startCountdown();

      // 祝福语数组
      const wishes = [
          "愿你每天都像今天一样快乐！",
          "祝你生日快乐，健康幸福！",
          "新的一岁，愿你梦想成真！",
          "愿所有美好与你不期而遇！",
          "生日快乐！愿你被世界温柔以待。",
          "新的一岁，平安喜乐，万事顺意！",
          "愿你的每一天都充满阳光和欢笑！",
          "生日快乐！愿你年年有今日，岁岁有今朝。"
      ];

      // 音乐信息 - 每一页对应不同的音乐
      const musicInfo = [
          { id: 'music-1', name: '生日快乐歌' },
          { id: 'music-2', name: '美好回忆曲' },
          { id: 'music-3', name: '欢乐庆典曲' },
          { id: 'music-4', name: '温馨祝福曲' }
      ];

      // 元素获取
      const wishContainer = document.getElementById('wish-container');
      const wishBtn = document.getElementById('wish-btn');
      const likeBtn = document.getElementById('like-btn');
      const shareBtn = document.getElementById('share-btn');
      const musicToggle = document.getElementById('music-toggle');
      const fireworksContainer = document.getElementById('fireworks-container');
      const pages = document.querySelectorAll('.page');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const musicIndicator = document.getElementById('music-indicator');
      const musicGuide = document.getElementById('music-guide');

      // 获取所有音乐元素
      const musicElements = musicInfo.reduce((acc, item) => {
          acc[item.id] = document.getElementById(item.id);
          return acc;
      }, {});

      // 翻页控制变量
      let currentPage = 0;
      const totalPages = pages.length;
      let isPlaying = false;
      let currentMusicId = musicInfo[0].id; // 默认第一首音乐

      // 音乐控制 - 播放指定页面的音乐
      function playPageMusic(pageIndex) {
          // 停止当前播放的音乐
          if (currentMusicId) {
              musicElements[currentMusicId].pause();
          }

          // 获取新页面的音乐信息
          const newMusic = musicInfo[pageIndex];
          currentMusicId = newMusic.id;

          // 更新指示器
          musicIndicator.textContent = `正在播放: ${newMusic.name}`;

          // 播放新音乐
          if (isPlaying) {
              musicElements[currentMusicId].play()
                  .catch(err => {
                      console.log("播放失败:", err);
                  });
          }
      }

      // 音乐总开关
      musicToggle.addEventListener('click', () => {
          if (isPlaying) {
              // 暂停当前音乐
              musicElements[currentMusicId].pause();
              musicToggle.innerHTML = '<i class="fa fa-music text-xl"></i>';
              isPlaying = false;
          } else {
              // 播放当前页面音乐
              musicElements[currentMusicId].play()
                  .then(() => {
                      musicToggle.innerHTML = '<i class="fa fa-pause text-xl"></i>';
                      isPlaying = true;
                      musicGuide.style.display = 'none'; // 隐藏引导提示
                  })
                  .catch(err => {
                      console.log("播放失败:", err);
                  });
          }
      });

      // 监听页面任何用户交互，触发播放
      function setupInteractionListeners() {
        const interactionHandler = () => {
          if (!isPlaying) {
              musicElements[currentMusicId].play()
                  .then(() => {
                      musicToggle.innerHTML = '<i class="fa fa-pause text-xl"></i>';
                      isPlaying = true;
                      musicGuide.style.display = 'none'; // 隐藏引导提示
                  })
                  .catch(err => {
                      console.log("播放失败:", err);
                  });
          }
          // 只需要一次交互即可，移除监听
          document.removeEventListener('click', interactionHandler);
          document.removeEventListener('touchstart', interactionHandler);
          document.removeEventListener('keydown', interactionHandler);
        };

        // 绑定多种交互方式
        document.addEventListener('click', interactionHandler);
        document.addEventListener('touchstart', interactionHandler);
        document.addEventListener('keydown', interactionHandler);
      }

      // 确保音乐循环的额外JavaScript保障
      Object.values(musicElements).forEach(music => {
          music.addEventListener('ended', () => {
              if (isPlaying && music.id === currentMusicId) {
                  music.play();
              }
          });
      });

      // 祝福切换
      let currentWishIndex = 0;
      wishBtn.addEventListener('click', () => {
        wishContainer.style.opacity = '0';
        wishContainer.style.transform = 'translateY(20px)';
        wishContainer.style.transition = 'opacity 0.5s, transform 0.5s';

        setTimeout(() => {
          currentWishIndex = (currentWishIndex + 1) % wishes.length;
          wishContainer.textContent = wishes[currentWishIndex];
          wishContainer.style.opacity = '1';
          wishContainer.style.transform = 'translateY(0)';
          createFireworks(3);
        }, 500);
      });

      // 点赞功能
      let liked = false;
      likeBtn.addEventListener('click', () => {
        if (liked) {
          likeBtn.innerHTML = '<i class="fa fa-heart-o"></i>';
          likeBtn.classList.remove('text-red-500');
          likeBtn.classList.add('text-white');
        } else {
          likeBtn.innerHTML = '<i class="fa fa-heart"></i>';
          likeBtn.classList.remove('text-white');
          likeBtn.classList.add('text-red-500');
          likeBtn.classList.add('animate-bounce');
          setTimeout(() => likeBtn.classList.remove('animate-bounce'), 1000);
          // 点赞时发射更多烟花
          createFireworks(10);
        }
        liked = !liked;
      });

      // 分享提示
      shareBtn.addEventListener('click', () => {
        alert('在微信中点击右上角，选择"分享到朋友圈"或发送给好友吧！');
      });

      // 烟花效果函数 - 增强版，可指定容器
      function createFireworks(count, container = fireworksContainer) {
        const colors = [
          '#FF6B8B', '#FFD700', '#9370DB', '#4ECDC4', '#45B7D1',
          '#FF5722', '#00E5FF', '#76FF03', '#FF4081', '#651FFF'
        ];

        for (let i = 0; i < count; i++) {
          setTimeout(() => {
            // 创建烟花容器
            const fireworkContainer = document.createElement('div');
            fireworkContainer.style.cssText = `
              position: absolute;
              pointer-events: none;
            `;

            // 随机位置和颜色
            const x = Math.random() * 100;
            const y = Math.random() * 60 + 20;
            const colorIndex = Math.floor(Math.random() * colors.length);
            const color = colors[colorIndex];
            const particleCount = Math.floor(Math.random() * 30) + 40; // 更多粒子
            const explosionSize = Math.random() * 150 + 100; // 更大的爆炸范围

            // 设置位置
            fireworkContainer.style.left = `${x}%`;
            fireworkContainer.style.top = `${y}%`;

            // 创建多个粒子
            for (let p = 0; p < particleCount; p++) {
              const particle = document.createElement('div');

              // 计算粒子角度和距离
              const angle = (p / particleCount) * Math.PI * 2;
              const distance = Math.random() * explosionSize;
              const particleSize = Math.random() * 4 + 2;

              // 计算终点位置
              const endX = Math.cos(angle) * distance;
              const endY = Math.sin(angle) * distance;

              // 粒子样式
              particle.style.cssText = `
                position: absolute;
                width: ${particleSize}px;
                height: ${particleSize}px;
                background: ${color};
                border-radius: 50%;
                box-shadow: 0 0 6px 2px ${color}CC;
                top: 0;
                left: 0;
                opacity: 0;
                transform: translate(0, 0);
                transition: all 1s cubic-bezier(0.1, 0.8, 0.9, 1);
              `;

              fireworkContainer.appendChild(particle);

              // 触发动画
              setTimeout(() => {
                particle.style.transform = `translate(${endX}px, ${endY}px)`;
                particle.style.opacity = 1;

                // 淡出效果
                setTimeout(() => {
                  particle.style.opacity = 0;
                }, 600);
              }, 10);
            }

            container.appendChild(fireworkContainer);

            // 清理
            setTimeout(() => {
              fireworkContainer.remove();
            }, 2000);
          }, i * 200);
        }
      }

      // 更新阴影效果
      function updateShadow(page, rotation) {
        const shadowOpacity = Math.abs(Math.sin(rotation * Math.PI / 180)) * 0.3;
        page.style.boxShadow = `
            -5px 0 20px ${shadowOpacity} rgba(0,0,0,0.2),
            inset 0 0 30px ${shadowOpacity * 0.5} rgba(0,0,0,0.1)
        `;
      }

      // 解析旋转角度
      function parseRotation(transform) {
        const matrix = new DOMMatrix(transform);
        const angle = Math.round(Math.atan2(matrix.b, matrix.a) * (180 / Math.PI));
        return angle < 0 ? angle + 360 : angle;
      }

      // 更新按钮状态
      function updateButtons() {
        prevBtn.disabled = currentPage === 0;
        nextBtn.disabled = currentPage === totalPages - 1;
      }

      // 翻到指定页并切换音乐
      function goToPage(index) {
        pages.forEach((page, i) => {
          page.classList.remove('active', 'prev', 'next', 'flipping');

          if (i === index) {
            page.classList.add('active');
          } else if (i < index) {
            page.classList.add('prev');
          } else {
            page.classList.add('next');
          }
        });

        // 切换到新页面的音乐
        playPageMusic(index);

        currentPage = index;
        updateButtons();
      }

      // 下一页
      nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages - 1) {
          const current = pages[currentPage];
          current.classList.add('flipping');

          // 监听过渡效果，更新阴影
          const handleTransition = () => {
            const transform = getComputedStyle(current).transform;
            const rotation = parseRotation(transform);
            updateShadow(current, rotation);
          };

          current.addEventListener('transition', handleTransition);

          // 翻页完成
          setTimeout(() => {
            current.removeEventListener('transition', handleTransition);
            goToPage(currentPage + 1);
            createFireworks(5);
          }, 800);
        }
      });

      // 上一页
      prevBtn.addEventListener('click', () => {
        if (currentPage > 0) {
          goToPage(currentPage - 1);
          createFireworks(5);

          // 如果回到第一页，重新启动烟花效果
          if (currentPage === 0) {
              startFirstPageFireworks();
          }
        }
      });

      // 初始化
      updateButtons();
      setupInteractionListeners();
  });
</script>
</body>
</html>
